{% extends 'MILK/base.html' %}
{% load staticfiles %}

{% block title_block %}
		{{ selecteduser.username }} Profile
{% endblock %}

{% block body_block %}

<div id=profilepage>
	<div class="col-md-6">
		  <h3>{{ selecteduser.username }}'s profile</h3>

			{% if userprofile.picture %}
				<img src="{{ MEDIA_URL }}{{ userprofile.picture }}"
		     	width="64"
		     	height="64"
		     	alt="{{ selecteduser.username }}" />
					<br/>
			{% else %}
					<img width="64" height="64" src="http://lorempixel.com/64/64/people/"/>
					{% if selecteduser.username == user.username %}
							Why not upload your own profile picture?
					{% else %}
							{{ selecteduser.username }} hasn't uploaded a profile picture.
					{% endif %}
			{% endif %}

			<!--Display the user's balance  -->
			<h5>{{ selecteduser.username }}'s current balance: {{ userprofile.balance }}</h5>

			{% if selecteduser.groups.all.0 %}
					Member of group: {{ selecteduser.groups.all.0 }}</br>
					<a href="{% url 'group' user.groups.all.0 %}">Visit your group page</a>
			{% else %}
						<!--Selected user does not have a group-->
						<h5>Not a member of any groups :(</h5>

						<!-- If the user is viewing their own profile...  -->
						{% if selecteduser.username == user.username %}
							<div>
								<!-- User has no group, so we give them the option to create a group -->
								{% include 'MILK/createGroupTemplate.html' %}
							</div>
						{% endif %}</br>
			{% endif %}
	</div>

	{% if selecteduser.username == user.username %}
		<div class="col-md-6">
				<form id="picture_form" method="post" action"." enctype="multipart/form-data">

						{% csrf_token %}

						{% for hidden in pictureform.hidden_fields %}
							{{ hidden }}
						{% endfor %}

						{% for field in pictureform.visible_fields %}
								{{ field.errors }}
								<h3>{{ field.help_text }}</h3>
								{{ field }}
						{% endfor %}
					<!-- Button to click to submit the form -->
					<input type="submit" name="picturebutton" value="Upload"/>
				</form>
		</div>
	</div>

	{% if selecteduser.groups.all.0 %}
	<div class="col-md-12">
			<hr/>
			<h3>Add stuff </h3>

			<form id="itemForm" method="post" action".">


				{% csrf_token %}

				{% for hidden in form.hidden_fields %}
          {{ hidden }}
        {% endfor %}

				{% for field in form.visible_fields %}
            {{ field.errors }}
            {{ field.help_text }}
            {{ field }}
				{% endfor %}

				<!-- Button to click to submit the form -->
				<input type="submit" name="itembutton" value="Add Item" onClick="myAlert()"/>
			</form>


					<!-- Shouldn't popup if there was an error with adding item -->
					<script>
						function myAlert() {
							alert("Item successfully added")}
					</script>
		</div>


		<!-- View Group list -->
		<div class= "col-md-12">
				<hr/>
				<h3>Communal shopping list:</h3>

				<div class=scroll-list>
						{% if Items %}
							{% for item in Items %}
								<!-- Only show the items belonging to this group! -->
								{% if selecteduser.groups.all.0 == item.groupBuying %}
									<li>{{ item.itemName }}</li>
								{% endif %}
							{% endfor %}
						{% else %}
							Your shopping list is empty.
						{% endif %}
				</div>
		</div>
		{% endif %}
{% endif %}

{% endblock %}

{% block side_block %}
	{% if user.is_authenticated %}
		<!-- Silly to sidebar profile here as well, can override it by adding this tag -->
	{% endif %}
{% endblock %}
