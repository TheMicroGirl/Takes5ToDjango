{% extends 'MILK/base.html' %}
{% load staticfiles %}

{% block title_block %}
  Home
{% endblock %}

{% block body_block %}
<h1> <img src="{%static "images/milklogo.png" %}" alt="Milk Carton Logo" height ="100"/>
  Welcome to Passive Aggressive Cost-Sharing Application v. 3.14159265358979
</h1>

<!-- Stylesheet for the Google Maps box  -->
<link rel="stylesheet" href="{% static 'css/googlemapsstylesheet.css' %}" />

<section>

    {% if user.is_authenticated %}
      Welcome back, {{ user.username }} </br>
      </br>

      <div>
          <h6>Communal shopping list: (Need to handle a single group's empty list more gracefully! Also lets make lists scrollable)</h6>
      </div>

      <div class="scroll-list">
          {% if Items %}
            {% for item in Items %}
              {% if user.groups.all.0 == item.groupBuying %}
                <li>
                    {{ item.itemName }}
                </li>
              {% endif %}
            {% endfor %}
          {% else %} Your shopping list is empty. {% endif %}
          </br>
      </div>

      <a href="{% url 'needsbought' %}">Running out of something? Mark it as needing bought here!</a>
      <h6> Items you need to <strong>pick up</strong> (just like the name of the app!)</h6>

      <div class=scroll-list>
          {% if Items %}
            {% for item in Items %}
              {% if user.groups.all.0 == item.groupBuying %}
                {% if item.itemNeedsBought %}
                  <li>
                      {{ item.itemName }}
                  </li>
                {% endif %}
              {% endif %}
            {% endfor %}
          {% endif %}
      </div>



      </div><!--Should this only appear if there are items in the to buy list
         should we be able to add and record the purchase of items on the same page
         For the case of someone realising then need something when they are in the shop-->
          <a href="{% url 'buyitem' %}">Record a purchase</a>
    </section>
    </br>

    <a href="{% url 'settle-up' user.groups.all.0 %}">Settle Up the Balance</a>
      <!--Should this only appear if there are items in the to buy list
           should we be able to add and record the purchase of items on the same page
           For the case of someone realising then need something when they are in the shop-->
      <a href="{% url 'recordpurchase' %}">Record a purchase</a>

    {% else %}
    <!-- User not authenticated -->
        <!-- Line below demonstrates how we would include another template -->
        <!-- {% include 'MILK/notloggedin.html' %} -->

        Use our website and we will harvest your shopping data and use it to target ads at you!

      <aside>
          <p>
              <a href="{% url 'auth_login' %}?/next=/">Login</a> or
              <a href="{% url 'registration_register' %}">Register</a>
              <p>
      </aside>

    {% endif %}
</section>

</br>

<!-- Insert Google Maps box -->
<center>
<section>
      Search for your nearest store!</br>
      Note: this can easily moved to another page. Could be cool to implement custom css so it stays at bottom of page as a footer. Can easily resize.
      <!--Change size of width/height parameters for map display here.-->
      <div id="map" style="width: 100%; height: 400px;"></div>

      <input id="pac-input" class="controls" type="text" placeholder="Find your closest shop...">
      <!--Load maps.js javascript file  -->
      <script src="{% static "js/maps.js" %}"></script>
      <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCHUixbKEMTudErjgqYCYg4Ukil-5EuSFE&libraries=places&callback=initialise" async defer></script>
      </div>
</section>
</center>
{% endblock %}
